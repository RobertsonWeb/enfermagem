-- MySQL Script generated by MySQL Workbench
-- Wed Dec 27 15:08:32 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema enfermagem
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema enfermagem
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `enfermagem` DEFAULT CHARACTER SET utf8 ;
USE `enfermagem` ;

-- -----------------------------------------------------
-- Table `enfermagem`.`INSTITUICAO`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `enfermagem`.`INSTITUICAO` ;

CREATE TABLE IF NOT EXISTS `enfermagem`.`INSTITUICAO` (
  `ID_INSTITUICAO` SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `SIGLA` VARCHAR(20) NOT NULL,
  `NOME` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`ID_INSTITUICAO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `enfermagem`.`MIDIA`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `enfermagem`.`MIDIA` ;

CREATE TABLE IF NOT EXISTS `enfermagem`.`MIDIA` (
  `ID_MIDIA` INT NOT NULL AUTO_INCREMENT,
  `LEGENDA` VARCHAR(250) NULL,
  `ARQUIVO` VARCHAR(100) NOT NULL,
  `IT_TBI_TIPO` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_MIDIA`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `enfermagem`.`INJURIA`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `enfermagem`.`INJURIA` ;

CREATE TABLE IF NOT EXISTS `enfermagem`.`INJURIA` (
  `ID_INJURIA` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `NOME` VARCHAR(250) NULL,
  `DESCRICAO` LONGTEXT NOT NULL,
  `ID_INSTITUICAO` SMALLINT UNSIGNED NOT NULL,
  `ID_MIDIA_TEXTO` INT NULL,
  `ID_MIDIA_IMAGEM` INT NULL,
  `ID_MIDIA_AUDIO` INT NULL,
  PRIMARY KEY (`ID_INJURIA`),
  INDEX `FK_INJURIA_MIDIA_TEXO_idx` (`ID_MIDIA_TEXTO` ASC),
  INDEX `FK_INJURIA_MIDIA_IMAGEM_idx` (`ID_MIDIA_IMAGEM` ASC),
  INDEX `FK_INJURIA_MIDIA_AUDIO_idx` (`ID_MIDIA_AUDIO` ASC),
  INDEX `FK_INJURIA_INSTITUICAO` (`ID_INSTITUICAO` ASC),
  CONSTRAINT `FK_INJURIA_INSTITUICAO`
    FOREIGN KEY (`ID_INSTITUICAO`)
    REFERENCES `enfermagem`.`INSTITUICAO` (`ID_INSTITUICAO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_INJURIA_MIDIA_AUDIO`
    FOREIGN KEY (`ID_MIDIA_AUDIO`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_INJURIA_MIDIA_IMAGEM`
    FOREIGN KEY (`ID_MIDIA_IMAGEM`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_INJURIA_MIDIA_TEXO`
    FOREIGN KEY (`ID_MIDIA_TEXTO`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `enfermagem`.`PERGUNTA`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `enfermagem`.`PERGUNTA` ;

CREATE TABLE IF NOT EXISTS `enfermagem`.`PERGUNTA` (
  `ID_PERGUNTA` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `NUMERO` SMALLINT NULL,
  `DESCRICAO` LONGTEXT NULL,
  `NUMERO_EXIBICOES` INT NOT NULL DEFAULT 0,
  `ID_INJURIA` INT UNSIGNED NOT NULL,
  `ID_MIDIA_TEXTO` INT NULL,
  `ID_MIDIA_IMAGEM` INT NULL,
  `ID_MIDIA_AUDIO` INT NULL,
  PRIMARY KEY (`ID_PERGUNTA`),
  INDEX `FK_PERGUNTA_MIDIA_IMAGEM_idx` (`ID_MIDIA_IMAGEM` ASC),
  INDEX `FK_PERGUNTA_MIDIA_AUDIO_idx` (`ID_MIDIA_AUDIO` ASC),
  INDEX `FK_PERGUNTA_MIDIA_TEXTO` (`ID_MIDIA_TEXTO` ASC),
  CONSTRAINT `FK_PERGUNTA_INJURIA`
    FOREIGN KEY (`ID_PERGUNTA`)
    REFERENCES `enfermagem`.`INJURIA` (`ID_INJURIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_PERGUNTA_MIDIA_AUDIO`
    FOREIGN KEY (`ID_MIDIA_AUDIO`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_PERGUNTA_MIDIA_IMAGEM`
    FOREIGN KEY (`ID_MIDIA_IMAGEM`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_PERGUNTA_MIDIA_TEXTO`
    FOREIGN KEY (`ID_MIDIA_TEXTO`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `enfermagem`.`RESPOSTA`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `enfermagem`.`RESPOSTA` ;

CREATE TABLE IF NOT EXISTS `enfermagem`.`RESPOSTA` (
  `ID_RESPOSTA` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `NUMERO` SMALLINT NOT NULL,
  `DESCRICAO` LONGTEXT NULL,
  `ID_MIDIA_TEXTO` INT NULL,
  `ID_MIDIA_IMAGEM` INT NULL,
  `ID_MIDIA_AUDIO` INT NULL,
  `ID_PERGUNTA` INT UNSIGNED NOT NULL,
  `ID_PERGUNTA_SEGUINTE` INT UNSIGNED NULL,
  PRIMARY KEY (`ID_RESPOSTA`),
  INDEX `FK_RESPOSTA_QUESTAO_idx` (`ID_PERGUNTA` ASC),
  INDEX `FK_RESPOSTA_MIDIA_idx` (`ID_MIDIA_TEXTO` ASC),
  INDEX `FK_RESPOSTA_PERGUNTA_SEGUINTE_idx` (`ID_PERGUNTA_SEGUINTE` ASC),
  INDEX `FK_RESPOSTA_MIDIA_IMAGEM_idx` (`ID_MIDIA_IMAGEM` ASC),
  INDEX `FK_RESPOSTA_MIDIA_AUDIO_idx` (`ID_MIDIA_AUDIO` ASC),
  CONSTRAINT `FK_RESPOSTA_MIDIA_AUDIO`
    FOREIGN KEY (`ID_MIDIA_AUDIO`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_RESPOSTA_MIDIA_TEXTO`
    FOREIGN KEY (`ID_MIDIA_TEXTO`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_RESPOSTA_MIDIA_IMAGEM`
    FOREIGN KEY (`ID_MIDIA_IMAGEM`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_RESPOSTA_PERGUNTA_SEGUINTE`
    FOREIGN KEY (`ID_PERGUNTA_SEGUINTE`)
    REFERENCES `enfermagem`.`PERGUNTA` (`ID_PERGUNTA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_RESPOSTA_PERGUNTA`
    FOREIGN KEY (`ID_PERGUNTA`)
    REFERENCES `enfermagem`.`PERGUNTA` (`ID_PERGUNTA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `enfermagem`.`USUARIO`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `enfermagem`.`USUARIO` ;

CREATE TABLE IF NOT EXISTS `enfermagem`.`USUARIO` (
  `ID_USUARIO` INT UNSIGNED NOT NULL,
  `NOME` VARCHAR(100) NOT NULL,
  `EMAIL` VARCHAR(100) NOT NULL,
  `SENHA` VARCHAR(128) NOT NULL,
  `FOTO` VARCHAR(20) NULL,
  `ID_INSTITUICAO` SMALLINT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_USUARIO`),
  INDEX `FK_USUARIO_INSTITUICAO_idx` (`ID_INSTITUICAO` ASC),
  CONSTRAINT `FK_USUARIO_INSTITUICAO`
    FOREIGN KEY (`ID_INSTITUICAO`)
    REFERENCES `enfermagem`.`INSTITUICAO` (`ID_INSTITUICAO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `enfermagem`.`ACAO`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `enfermagem`.`ACAO` ;

CREATE TABLE IF NOT EXISTS `enfermagem`.`ACAO` (
  `ID_ACAO` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `NUMERO` SMALLINT NOT NULL,
  `DESCRICAO` LONGTEXT NOT NULL,
  `ID_MIDIA_TEXTO` INT NULL,
  `ID_MIDIA_IMAGEM` INT NULL,
  `ID_MIDIA_AUDIO` INT NULL,
  `ID_RESPOSTA` INT(10) UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_ACAO`),
  INDEX `FK_ACAO_MIDIA_TEXTO_idx` (`ID_MIDIA_TEXTO` ASC),
  INDEX `FK_ACAO_MIDIA_IMAGEM_idx` (`ID_MIDIA_IMAGEM` ASC),
  INDEX `FK_ACAO_MIDIA_AUDIO_idx` (`ID_MIDIA_AUDIO` ASC),
  INDEX `FK_ACAO_RESPOSTA_idx` (`ID_RESPOSTA` ASC),
  CONSTRAINT `FK_ACAO_MIDIA_AUDIO`
    FOREIGN KEY (`ID_MIDIA_AUDIO`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_ACAO_MIDIA_IMAGEM`
    FOREIGN KEY (`ID_MIDIA_IMAGEM`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_ACAO_MIDIA_TEXTO`
    FOREIGN KEY (`ID_MIDIA_TEXTO`)
    REFERENCES `enfermagem`.`MIDIA` (`ID_MIDIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_ACAO_RESPOSTA`
    FOREIGN KEY (`ID_RESPOSTA`)
    REFERENCES `enfermagem`.`RESPOSTA` (`ID_RESPOSTA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
